<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
  <!-- Content Header (Page header) -->
  <div class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6">

        </div><!-- /.col -->
        <div class="col-sm-6">

        </div><!-- /.col -->
      </div><!-- /.row -->
    </div><!-- /.container-fluid -->
  </div>
  <!-- /.content-header -->

  <!-- Main content -->
  <section class="content">
    <div class="container-fluid">
      <div class="text-center description d-flex justify-content-center">
        <h1>Easily convert json objects to excel or csv</h1>
      </div>
      <div class="text-center d-flex justify-content-center">
        <p>Sometimes it is necessary to convert our json objects to a file type readable by people outside of the IT department. Idetek makes this job easy for you</p>
      </div>
      <div class="d-flex justify-content-center">
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">Json to excel</h2>
          </div>
          <div class="card-body">
            <!-- textarea -->
            <div class="form-group">
              <textarea #data [ngModel]="textareaData" (ngModelChange)="textareaChange($event)" class="form-control"
                rows="3" cols="100" placeholder="Paste your json object here..."></textarea>
            </div>
            <div *ngIf="showError" class="text-center alert alert-danger">
              {{ errorMessage }}
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Application buttons -->


    <div class="d-flex justify-content-center">
      <button (click)="downloadXLS()" [disabled]="!showData" class="btn btn-app bg-success">
        <i class="fas fa-file-excel"></i> excel
      </button>
      <button (click)="downloadCSV()" [disabled]="!showData" class="btn btn-app bg-info">
        <i class="fas fa-file-csv"></i> csv
      </button>
      <button (click)="reset()" class="btn btn-app bg-secondary">
        <i class="fas fa-eraser"></i> reset
      </button>
      <!-- /.card-body -->
    </div>
    <!-- /.card -->
    <div class="card" [hidden]="!showData"><!--[className]="showData ? 'showTable' : 'hideTable'"-->
      <div class="card-header">
        <h3 class="card-title">Json data</h3>
      </div>
      <!-- /.card-header -->
      
      <div class="card-body">
        <table id="table" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-bordered table-striped">
          <thead>
            <tr>
              <th *ngFor="let element of tableTitles">
                {{ element }}
              </th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let element of tableRows">
              <td *ngFor="let value of element">
                {{ value }}
              </td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <th *ngFor="let element of tableTitles">
                {{ element }}
              </th>
            </tr>
          </tfoot>
        </table>
      </div>
      <!-- /.card-body -->
    </div>
    <!-- /.card -->
  </section>
  <!-- /.content -->
</div>
<!-- /.content-wrapper -->